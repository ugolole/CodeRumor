var XRegExp;if(XRegExp)throw Error("can't load XRegExp twice in the same frame");(function(){function t(n,t){if(!XRegExp.isRegExp(n))throw TypeError("type RegExp expected");var i=n._xregexp;return n=XRegExp(n.source,h(n)+(t||"")),i&&(n._xregexp={source:i.source,captureNames:i.captureNames?i.captureNames.slice(0):null}),n}function h(n){return(n.global?"g":"")+(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.extended?"x":"")+(n.sticky?"y":"")}function y(n,t,u,f){var s=r.length,h,o,e;i=!0;try{while(s--)if(e=r[s],u&e.scope&&(!e.trigger||e.trigger.call(f))&&(e.pattern.lastIndex=t,o=e.pattern.exec(n),o&&o.index===t)){h={output:e.handler.call(f,o,u),match:o};break}}catch(c){throw c;}finally{i=!1}return h}function f(n,t,i){if(Array.prototype.indexOf)return n.indexOf(t,i);for(var r=i||0;r<n.length;r++)if(n[r]===t)return r;return-1}XRegExp=function(r,f){var o=[],s=XRegExp.OUTSIDE_CLASS,e=0,h,c,v,a,p;if(XRegExp.isRegExp(r)){if(f!==undefined)throw TypeError("can't supply flags when constructing one RegExp from another");return t(r)}if(i)throw Error("can't call the XRegExp constructor within token definition functions");for(f=f||"",h={hasNamedCapture:!1,captureNames:[],hasFlag:function(n){return f.indexOf(n)>-1},setFlag:function(n){f+=n}};e<r.length;)c=y(r,e,s,h),c?(o.push(c.output),e+=c.match[0].length||1):(v=n.exec.call(u[s],r.slice(e)))?(o.push(v[0]),e+=v[0].length):(a=r.charAt(e),a==="["?s=XRegExp.INSIDE_CLASS:a==="]"&&(s=XRegExp.OUTSIDE_CLASS),o.push(a),e++);return p=RegExp(o.join(""),n.replace.call(f,l,"")),p._xregexp={source:r,captureNames:h.hasNamedCapture?h.captureNames:null},p};XRegExp.version="1.5.0";XRegExp.INSIDE_CLASS=1;XRegExp.OUTSIDE_CLASS=2;var c=/\$(?:(\d\d?|[$&`'])|{([$\w]+)})/g,l=/[^gimy]+|([\s\S])(?=[\s\S]*\1)/g,e=/^(?:[?*+]|{\d+(?:,\d*)?})\??/,i=!1,r=[],n={exec:RegExp.prototype.exec,test:RegExp.prototype.test,match:String.prototype.match,replace:String.prototype.replace,split:String.prototype.split},a=n.exec.call(/()??/,"")[1]===undefined,o=function(){var t=/^/g;return n.test.call(t,""),!t.lastIndex}(),v=function(){var t=/x/g;return n.replace.call("x",t,""),!t.lastIndex}(),s=RegExp.prototype.sticky!==undefined,u={};u[XRegExp.INSIDE_CLASS]=/^(?:\\(?:[0-3][0-7]{0,2}|[4-7][0-7]?|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S]))/;u[XRegExp.OUTSIDE_CLASS]=/^(?:\\(?:0(?:[0-3][0-7]{0,2}|[4-7][0-7]?)?|[1-9]\d*|x[\dA-Fa-f]{2}|u[\dA-Fa-f]{4}|c[A-Za-z]|[\s\S])|\(\?[:=!]|[?*+]\?|{\d+(?:,\d*)?}\??)/;XRegExp.addToken=function(n,i,u,f){r.push({pattern:t(n,"g"+(s?"y":"")),handler:i,scope:u||XRegExp.OUTSIDE_CLASS,trigger:f||null})};XRegExp.cache=function(n,t){var i=n+"/"+(t||"");return XRegExp.cache[i]||(XRegExp.cache[i]=XRegExp(n,t))};XRegExp.copyAsGlobal=function(n){return t(n,"g")};XRegExp.escape=function(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};XRegExp.execAt=function(n,i,r,u){i=t(i,"g"+(u&&s?"y":""));i.lastIndex=r=r||0;var f=i.exec(n);return u?f&&f.index===r?f:null:f};XRegExp.freezeTokens=function(){XRegExp.addToken=function(){throw Error("can't run addToken after freezeTokens");}};XRegExp.isRegExp=function(n){return Object.prototype.toString.call(n)==="[object RegExp]"};XRegExp.iterate=function(n,i,r,u){for(var f=t(i,"g"),o=-1,e;e=f.exec(n);)r.call(u,e,++o,n,f),f.lastIndex===e.index&&f.lastIndex++;i.global&&(i.lastIndex=0)};XRegExp.matchChain=function(n,i){return function r(n,u){for(var o=i[u].regex?i[u]:{regex:i[u]},s=t(o.regex,"g"),f=[],e=0;e<n.length;e++)XRegExp.iterate(n[e],s,function(n){f.push(o.backref?n[o.backref]||"":n[0])});return u===i.length-1||!f.length?f:r(f,u+1)}([n],0)};RegExp.prototype.apply=function(n,t){return this.exec(t[0])};RegExp.prototype.call=function(n,t){return this.exec(t)};RegExp.prototype.exec=function(t){var i=n.exec.apply(this,arguments),u,e,r;if(i){if(!a&&i.length>1&&f(i,"")>-1&&(e=RegExp(this.source,n.replace.call(h(this),"g","")),n.replace.call(t.slice(i.index),e,function(){for(var n=1;n<arguments.length-2;n++)arguments[n]===undefined&&(i[n]=undefined)})),this._xregexp&&this._xregexp.captureNames)for(r=1;r<i.length;r++)u=this._xregexp.captureNames[r-1],u&&(i[u]=i[r]);!o&&this.global&&!i[0].length&&this.lastIndex>i.index&&this.lastIndex--}return i};o||(RegExp.prototype.test=function(t){var i=n.exec.call(this,t);return i&&this.global&&!i[0].length&&this.lastIndex>i.index&&this.lastIndex--,!!i});String.prototype.match=function(t){if(XRegExp.isRegExp(t)||(t=RegExp(t)),t.global){var i=n.match.apply(this,arguments);return t.lastIndex=0,i}return t.exec(this)};String.prototype.replace=function(t,i){var u=XRegExp.isRegExp(t),r,e,o;return u&&typeof i.valueOf()=="string"&&i.indexOf("${")===-1&&v?n.replace.apply(this,arguments):(u?t._xregexp&&(r=t._xregexp.captureNames):t=t+"",typeof i=="function"?e=n.replace.call(this,t,function(){if(r){arguments[0]=new String(arguments[0]);for(var n=0;n<r.length;n++)r[n]&&(arguments[0][r[n]]=arguments[n+1])}return u&&t.global&&(t.lastIndex=arguments[arguments.length-2]+arguments[0].length),i.apply(null,arguments)}):(o=this+"",e=n.replace.call(o,t,function(){var t=arguments;return n.replace.call(i,c,function(n,i,u){var o,e;if(i)switch(i){case"$":return"$";case"&":return t[0];case"`":return t[t.length-1].slice(0,t[t.length-2]);case"'":return t[t.length-1].slice(t[t.length-2]+t[0].length);default:if(o="",i=+i,!i)return n;while(i>t.length-3)o=String.prototype.slice.call(i,-1)+o,i=Math.floor(i/10);return(i?t[i]||"":"$")+o}else return(e=+u,e<=t.length-3)?t[e]:(e=r?f(r,u):-1,e>-1?t[e+1]:n)})})),u&&t.global&&(t.lastIndex=0),e)};String.prototype.split=function(t,i){if(!XRegExp.isRegExp(t))return n.split.apply(this,arguments);var f=this+"",r=[],e=0,u,o;if(i===undefined||+i<0)i=Infinity;else if(i=Math.floor(+i),!i)return[];for(t=XRegExp.copyAsGlobal(t);u=t.exec(f);){if(t.lastIndex>e&&(r.push(f.slice(e,u.index)),u.length>1&&u.index<f.length&&Array.prototype.push.apply(r,u.slice(1)),o=u[0].length,e=t.lastIndex,r.length>=i))break;t.lastIndex===u.index&&t.lastIndex++}return e===f.length?(!n.test.call(t,"")||o)&&r.push(""):r.push(f.slice(e)),r.length>i?r.slice(0,i):r};XRegExp.addToken(/\(\?#[^)]*\)/,function(t){return n.test.call(e,t.input.slice(t.index+t[0].length))?"":"(?:)"});XRegExp.addToken(/\((?!\?)/,function(){return this.captureNames.push(null),"("});XRegExp.addToken(/\(\?<([$\w]+)>/,function(n){return this.captureNames.push(n[1]),this.hasNamedCapture=!0,"("});XRegExp.addToken(/\\k<([\w$]+)>/,function(n){var t=f(this.captureNames,n[1]);return t>-1?"\\"+(t+1)+(isNaN(n.input.charAt(n.index+n[0].length))?"":"(?:)"):n[0]});XRegExp.addToken(/\[\^?]/,function(n){return n[0]==="[]"?"\\b\\B":"[\\s\\S]"});XRegExp.addToken(/^\(\?([imsx]+)\)/,function(n){return this.setFlag(n[1]),""});XRegExp.addToken(/(?:\s+|#.*)+/,function(t){return n.test.call(e,t.input.slice(t.index+t[0].length))?"":"(?:)"},XRegExp.OUTSIDE_CLASS,function(){return this.hasFlag("x")});XRegExp.addToken(/\./,function(){return"[\\s\\S]"},XRegExp.OUTSIDE_CLASS,function(){return this.hasFlag("s")})})();typeof exports!="undefined"?exports.XRegExp=XRegExp:null;