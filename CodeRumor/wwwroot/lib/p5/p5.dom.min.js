/*! p5.dom.js v0.3.4 Jan 19, 2017 */
(function(n,t){typeof define=="function"&&define.amd?define("p5.dom",["p5"],function(n){t(n)}):typeof exports=="object"?t(require("../p5")):t(n.p5)})(this,function(n){function i(t){var i=document;return typeof t=="string"&&t[0]==="#"?(t=t.slice(1),i=document.getElementById(t)||document):t instanceof n.Element?i=t.elt:t instanceof HTMLElement&&(i=t),i}function t(t,i,r){var f=i._userNode?i._userNode:document.body,u;return f.appendChild(t),u=r?new n.MediaElement(t):new n.Element(t),i._elements.push(u),u}function u(n,i,r,u){var e=document.createElement(i),o,s,h,f;for(r=r||"",typeof r=="string"&&(r=[r]),o=0;o<r.length;o++)s=document.createElement("source"),s.src=r[o],e.appendChild(s);return typeof u!="undefined"&&(h=function(){u();e.removeEventListener("canplaythrough",h)},e.addEventListener("canplaythrough",h)),f=t(e,n,!0),f.loadedmetadata=!1,e.addEventListener("loadedmetadata",function(){f.width=e.videoWidth;f.height=e.videoHeight;f.elt.width===0&&(f.elt.width=e.videoWidth);f.elt.height===0&&(f.elt.height=e.videoHeight);f.loadedmetadata=!0}),f}var r,f;n.prototype.select=function(t,r){n._validateParameters("select",arguments);var u=null,f=i(r);return t[0]==="."?(t=t.slice(1),u=f.getElementsByClassName(t),u=u.length?u[0]:null):t[0]==="#"?(t=t.slice(1),u=f.getElementById(t)):(u=f.getElementsByTagName(t),u=u.length?u[0]:null),u?this._wrapElement(u):null};n.prototype.selectAll=function(t,r){var e,u,o,f,s;if(n._validateParameters("selectAll",arguments),e=[],o=i(r),t[0]==="."?(t=t.slice(1),u=o.getElementsByClassName(t)):u=o.getElementsByTagName(t),u)for(f=0;f<u.length;f++)s=this._wrapElement(u[f]),e.push(s);return e};n.prototype._wrapElement=function(t){var r=Array.prototype.slice.call(t.children),i;return t.tagName==="INPUT"&&t.type==="checkbox"?(i=new n.Element(t),i.checked=function(){return arguments.length===0?this.elt.checked:(this.elt.checked=arguments[0]?!0:!1,this)},i):t.tagName==="VIDEO"||t.tagName==="AUDIO"?new n.MediaElement(t):t.tagName==="SELECT"?this.createSelect(new n.Element(t)):r.length>0&&r.every(function(n){return n.tagName==="INPUT"||n.tagName==="LABEL"})?this.createRadio(new n.Element(t)):new n.Element(t)};n.prototype.removeElements=function(){n._validateParameters("removeElements",arguments);for(var t=0;t<this._elements.length;t++)this._elements[t].elt instanceof HTMLCanvasElement||this._elements[t].remove()};r=["div","p","span"];r.forEach(function(i){var r="create"+i.charAt(0).toUpperCase()+i.slice(1);n.prototype[r]=function(n){var r=document.createElement(i);return r.innerHTML=typeof n===undefined?"":n,t(r,this)}});n.prototype.createImg=function(){n._validateParameters("createImg",arguments);var r=document.createElement("img"),i=arguments,u,f=function(){u.width=r.offsetWidth||r.width;u.height=r.offsetHeight||r.height;i.length>1&&typeof i[1]=="function"?(u.fn=i[1],u.fn()):i.length>1&&typeof i[2]=="function"&&(u.fn=i[2],u.fn())};return r.src=i[0],i.length>1&&typeof i[1]=="string"&&(r.alt=i[1]),r.onload=function(){f()},u=t(r,this)};n.prototype.createA=function(i,r,u){n._validateParameters("createA",arguments);var f=document.createElement("a");return f.href=i,f.innerHTML=r,u&&(f.target=u),t(f,this)};n.prototype.createSlider=function(i,r,u,f){n._validateParameters("createSlider",arguments);var e=document.createElement("input");return e.type="range",e.min=i,e.max=r,f===0?e.step=1e-18:f&&(e.step=f),typeof u=="number"&&(e.value=u),t(e,this)};n.prototype.createButton=function(i,r){n._validateParameters("createButton",arguments);var u=document.createElement("button");return u.innerHTML=i,r&&(u.value=r),t(u,this)};n.prototype.createCheckbox=function(){var u,r,i,e,f;return n._validateParameters("createCheckbox",arguments),u=document.createElement("div"),r=document.createElement("input"),r.type="checkbox",u.appendChild(r),i=t(u,this),i.checked=function(){var n=i.elt.getElementsByTagName("input")[0];if(n){if(arguments.length===0)return n.checked;n.checked=arguments[0]?!0:!1}return i},this.value=function(n){return i.value=n,this},arguments[0]&&(e=Math.random().toString(36).slice(2),f=document.createElement("label"),r.setAttribute("id",e),f.htmlFor=e,i.value(arguments[0]),f.appendChild(document.createTextNode(arguments[0])),u.appendChild(f)),arguments[1]&&(r.checked=!0),i};n.prototype.createSelect=function(){n._validateParameters("createSelect",arguments);var r,u,i=arguments[0];return typeof i=="object"&&i.elt.nodeName==="SELECT"?(u=i,r=this.elt=i.elt):(r=document.createElement("select"),i&&typeof i=="boolean"&&r.setAttribute("multiple","true"),u=t(r,this)),u.option=function(n,t){for(var f,i,u=0;u<this.elt.length;u++)if(this.elt[u].innerHTML===n){i=u;break}i!==undefined?t===!1?this.elt.remove(i):this.elt[i].innerHTML===this.elt[i].value?this.elt[i].innerHTML=this.elt[i].value=t:this.elt[i].value=t:(f=document.createElement("option"),f.innerHTML=n,f.value=arguments.length>1?t:n,r.appendChild(f))},u.selected=function(n){var i=[],t;if(arguments.length>0){for(t=0;t<this.elt.length;t++)n.toString()===this.elt[t].value&&(this.elt.selectedIndex=t);return this}if(this.elt.getAttribute("multiple")){for(t=0;t<this.elt.selectedOptions.length;t++)i.push(this.elt.selectedOptions[t].value);return i}return this.elt.value},u};n.prototype.createRadio=function(i){var u,f,o,e,r,s;if(n._validateParameters("createRadio",arguments),u=document.querySelectorAll("input[type=radio]"),f=0,u.length>1){var l=u.length,c=u[0].name,h=u[1].name;for(f=1,o=1;o<l;o++)h=u[o].name,c!==h&&f++,c=h}else u.length===1&&(f=1);return typeof i=="object"?(r=i,e=this.elt=i.elt):(e=document.createElement("div"),r=t(e,this)),r._getInputChildrenArray=function(){return Array.prototype.slice.call(this.elt.children).filter(function(n){return n.tagName==="INPUT"})},s=-1,r.option=function(n,t){var i=document.createElement("input"),r;return i.type="radio",i.innerHTML=n,i.value=t?t:n,i.setAttribute("name","defaultradio"+f),e.appendChild(i),n&&(s++,r=document.createElement("label"),i.setAttribute("id","defaultradio"+f+"-"+s),r.htmlFor="defaultradio"+f+"-"+s,r.appendChild(document.createTextNode(n)),e.appendChild(r)),i},r.selected=function(n){var t,i=r._getInputChildrenArray();if(n){for(t=0;t<i.length;t++)i[t].value===n&&(i[t].checked=!0);return this}for(t=0;t<i.length;t++)if(i[t].checked===!0)return i[t].value},r.value=function(n){var t,i=r._getInputChildrenArray();if(n){for(t=0;t<i.length;t++)i[t].value===n&&(i[t].checked=!0);return this}for(t=0;t<i.length;t++)if(i[t].checked===!0)return i[t].value;return""},r};n.prototype.createInput=function(i,r){n._validateParameters("createInput",arguments);var u=document.createElement("input");return u.type=r?r:"text",i&&(u.value=i),t(u,this)};n.prototype.createFileInput=function(i,r){function f(t){function o(t){var r=new n.File(t);return function(n){r.data=n.target.result;i(r)}}for(var r,u,e=t.target.files,f=0;f<e.length;f++)r=e[f],u=new FileReader,u.onload=o(r),r.type.indexOf("text")>-1?u.readAsText(r):u.readAsDataURL(r)}if(n._validateParameters("createFileInput",arguments),window.File&&window.FileReader&&window.FileList&&window.Blob){var u=document.createElement("input");return u.type="file",r&&(u.multiple="multiple"),u.addEventListener("change",f,!1),t(u,this)}console.log("The File APIs are not fully supported in this browser. Cannot create element.")};n.prototype.createVideo=function(t,i){return n._validateParameters("createVideo",arguments),u(this,"video",t,i)};n.prototype.createAudio=function(t,i){return n._validateParameters("createAudio",arguments),u(this,"audio",t,i)};n.prototype.VIDEO="video";n.prototype.AUDIO="audio";navigator.mediaDevices===undefined&&(navigator.mediaDevices={});navigator.mediaDevices.getUserMedia===undefined&&(navigator.mediaDevices.getUserMedia=function(n){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise(function(i,r){t.call(navigator,n,i,r)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))});n.prototype.createCapture=function(){var e,o,f,s,u,i,r;for(n._validateParameters("createCapture",arguments),e=!0,o=!0,u=0;u<arguments.length;u++)arguments[u]===n.prototype.VIDEO?o=!1:arguments[u]===n.prototype.AUDIO?e=!1:typeof arguments[u]=="object"?f=arguments[u]:typeof arguments[u]=="function"&&(s=arguments[u]);if(navigator.getUserMedia)i=document.createElement("video"),f||(f={video:e,audio:o}),navigator.mediaDevices.getUserMedia(f).then(function(n){try{"srcObject"in i?i.srcObject=n:i.src=window.URL.createObjectURL(n)}catch(t){i.src=n}s&&s(n)},function(n){console.log(n)});else throw"getUserMedia not supported in this browser";return r=t(i,this,!0),r.loadedmetadata=!1,i.addEventListener("loadedmetadata",function(){i.play();i.width?(r.width=i.videoWidth=i.width,r.height=i.videoHeight=i.height):(r.width=r.elt.width=i.videoWidth,r.height=r.elt.height=i.videoHeight);r.loadedmetadata=!0}),r};n.prototype.createElement=function(i,r){n._validateParameters("createElement",arguments);var u=document.createElement(i);return typeof r!="undefined"&&(u.innerHTML=r),t(u,this)};n.Element.prototype.addClass=function(n){return this.elt.className=this.elt.className?this.elt.className+" "+n:n,this};n.Element.prototype.removeClass=function(n){var t=new RegExp("(?:^|\\s)"+n+"(?!\\S)");return this.elt.className=this.elt.className.replace(t,""),this.elt.className=this.elt.className.replace(/^\s+|\s+$/g,""),this};n.Element.prototype.child=function(t){return typeof t=="undefined"?this.elt.childNodes:(typeof t=="string"?(t[0]==="#"&&(t=t.substring(1)),t=document.getElementById(t)):t instanceof n.Element&&(t=t.elt),this.elt.appendChild(t),this)};n.Element.prototype.center=function(n){var e=this.elt.style.display,t=this.elt.style.display==="none",i=this.parent().style.display==="none",r={x:this.elt.offsetLeft,y:this.elt.offsetTop};t&&this.show();this.elt.style.display="block";this.position(0,0);i&&(this.parent().style.display="block");var u=Math.abs(this.parent().offsetWidth-this.elt.offsetWidth),f=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight),o=r.y,s=r.x;return n==="both"||n===undefined?this.position(u/2,f/2):n==="horizontal"?this.position(u/2,o):n==="vertical"&&this.position(s,f/2),this.style("display",e),t&&this.hide(),i&&(this.parent().style.display="none"),this};n.Element.prototype.html=function(){return arguments.length===0?this.elt.innerHTML:arguments[1]?(this.elt.innerHTML+=arguments[0],this):(this.elt.innerHTML=arguments[0],this)};n.Element.prototype.position=function(){return arguments.length===0?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position="absolute",this.elt.style.left=arguments[0]+"px",this.elt.style.top=arguments[1]+"px",this.x=arguments[0],this.y=arguments[1],this)};n.Element.prototype._translate=function(){this.elt.style.position="absolute";var n="";return this.elt.style.transform&&(n=this.elt.style.transform.replace(/translate3d\(.*\)/g,""),n=n.replace(/translate[X-Z]?\(.*\)/g,"")),arguments.length===2?this.elt.style.transform="translate("+arguments[0]+"px, "+arguments[1]+"px)":arguments.length>2&&(this.elt.style.transform="translate3d("+arguments[0]+"px,"+arguments[1]+"px,"+arguments[2]+"px)",this.elt.parentElement.style.perspective=arguments.length===3?"1000px":arguments[3]+"px"),this.elt.style.transform+=n,this};n.Element.prototype._rotate=function(){var n="";return this.elt.style.transform&&(n=this.elt.style.transform.replace(/rotate3d\(.*\)/g,""),n=n.replace(/rotate[X-Z]?\(.*\)/g,"")),arguments.length===1?this.elt.style.transform="rotate("+arguments[0]+"deg)":arguments.length===2?this.elt.style.transform="rotate("+arguments[0]+"deg, "+arguments[1]+"deg)":arguments.length===3&&(this.elt.style.transform="rotateX("+arguments[0]+"deg)",this.elt.style.transform+="rotateY("+arguments[1]+"deg)",this.elt.style.transform+="rotateZ("+arguments[2]+"deg)"),this.elt.style.transform+=n,this};n.Element.prototype.style=function(t,i){var l=this,o,s,f,u,r,e,h,c;if(i instanceof n.Color&&(i="rgba("+i.levels[0]+","+i.levels[1]+","+i.levels[2]+","+i.levels[3]/255+")"),typeof i=="undefined"){if(t.indexOf(":")===-1)return o=window.getComputedStyle(l.elt),s=o.getPropertyValue(t),s;for(f=t.split(";"),u=0;u<f.length;u++)r=f[u].split(":"),r[0]&&r[1]&&(this.elt.style[r[0].trim()]=r[1].trim())}else t==="rotate"||t==="translate"||t==="position"?(e=Array.prototype.shift.apply(arguments),h=this[e]||this["_"+e],h.apply(this,arguments)):(this.elt.style[t]=i,(t==="width"||t==="height"||t==="left"||t==="top")&&(c=i.replace(/\D+/g,""),this[t]=parseInt(c,10)));return this};n.Element.prototype.attribute=function(n,t){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio")){if(typeof t=="undefined")return this.elt.firstChild.getAttribute(n);for(var i=0;i<this.elt.childNodes.length;i++)this.elt.childNodes[i].setAttribute(n,t)}else return typeof t=="undefined"?this.elt.getAttribute(n):(this.elt.setAttribute(n,t),this)};n.Element.prototype.removeAttribute=function(n){if(this.elt.firstChild!=null&&(this.elt.firstChild.type==="checkbox"||this.elt.firstChild.type==="radio"))for(var t=0;t<this.elt.childNodes.length;t++)this.elt.childNodes[t].removeAttribute(n);return this.elt.removeAttribute(n),this};n.Element.prototype.value=function(){return arguments.length>0?(this.elt.value=arguments[0],this):this.elt.type==="range"?parseFloat(this.elt.value):this.elt.value};n.Element.prototype.show=function(){return this.elt.style.display="block",this};n.Element.prototype.hide=function(){return this.elt.style.display="none",this};n.Element.prototype.size=function(t,i){var o,s,f;if(arguments.length===0)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var r=t,u=i,e=n.prototype.AUTO;if(r!==e||u!==e){if(r===e?r=i*this.width/this.height:u===e&&(u=t*this.height/this.width),this.elt instanceof HTMLCanvasElement){o={};s=this.elt.getContext("2d");for(f in s)o[f]=s[f];this.elt.setAttribute("width",r*this._pInst._pixelDensity);this.elt.setAttribute("height",u*this._pInst._pixelDensity);this.elt.setAttribute("style","width:"+r+"px; height:"+u+"px");this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity);for(f in o)this.elt.getContext("2d")[f]=o[f]}else this.elt.style.width=r+"px",this.elt.style.height=u+"px",this.elt.width=r,this.elt.height=u,this.width=r,this.height=u;this.width=this.elt.offsetWidth;this.height=this.elt.offsetHeight;this._pInst&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",this.elt.offsetWidth),this._pInst._setProperty("height",this.elt.offsetHeight))}return this};n.Element.prototype.remove=function(){for(var n in this._events)this.elt.removeEventListener(n,this._events[n]);this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);delete this};n.MediaElement=function(t,i){n.Element.call(this,t,i);var r=this;this.elt.crossOrigin="anonymous";this._prevTime=0;this._cueIDCounter=0;this._cues=[];this._pixelDensity=1;this._modified=!1;Object.defineProperty(r,"src",{get:function(){var n=r.elt.children[0].src,t=r.elt.src===window.location.href?"":r.elt.src;return n===window.location.href?t:n},set:function(n){for(var u,i=0;i<r.elt.children.length;i++)r.elt.removeChild(r.elt.children[i]);u=document.createElement("source");u.src=n;t.appendChild(u);r.elt.src=n;r.modified=!0}});r._onended=function(){};r.elt.onended=function(){r._onended(r)}};n.MediaElement.prototype=Object.create(n.Element.prototype);n.MediaElement.prototype.play=function(){return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),this.elt.readyState>1?this.elt.play():(this.elt.load(),this.elt.play()),this};n.MediaElement.prototype.stop=function(){return this.elt.pause(),this.elt.currentTime=0,this};n.MediaElement.prototype.pause=function(){return this.elt.pause(),this};n.MediaElement.prototype.loop=function(){return this.elt.setAttribute("loop",!0),this.play(),this};n.MediaElement.prototype.noLoop=function(){return this.elt.setAttribute("loop",!1),this};n.MediaElement.prototype.autoplay=function(n){return this.elt.setAttribute("autoplay",n),this};n.MediaElement.prototype.volume=function(n){if(typeof n=="undefined")return this.elt.volume;this.elt.volume=n};n.MediaElement.prototype.speed=function(n){if(typeof n=="undefined")return this.elt.playbackRate;this.elt.playbackRate=n};n.MediaElement.prototype.time=function(n){if(typeof n=="undefined")return this.elt.currentTime;this.elt.currentTime=n};n.MediaElement.prototype.duration=function(){return this.elt.duration};n.MediaElement.prototype.pixels=[];n.MediaElement.prototype.loadPixels=function(){return this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d")),this.loadedmetadata&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),n.Renderer2D.prototype.loadPixels.call(this)),this.setModified(!0),this};n.MediaElement.prototype.updatePixels=function(t,i,r,u){return this.loadedmetadata&&n.Renderer2D.prototype.updatePixels.call(this,t,i,r,u),this.setModified(!0),this};n.MediaElement.prototype.get=function(t,i,r,u){return this.loadedmetadata?n.Renderer2D.prototype.get.call(this,t,i,r,u):typeof t=="undefined"?new n.Image(1,1):r>1?new n.Image(t,i,r,u):[0,0,0,255]};n.MediaElement.prototype.set=function(t,i,r){this.loadedmetadata&&(n.Renderer2D.prototype.set.call(this,t,i,r),this.setModified(!0))};n.MediaElement.prototype.copy=function(){n.Renderer2D.prototype.copy.apply(this,arguments)};n.MediaElement.prototype.mask=function(){this.loadPixels();this.setModified(!0);n.Image.prototype.mask.apply(this,arguments)};n.MediaElement.prototype.isModified=function(){return this._modified};n.MediaElement.prototype.setModified=function(n){this._modified=n};n.MediaElement.prototype.onended=function(n){return this._onended=n,this};n.MediaElement.prototype.connect=function(t){var i,r;if(typeof n.prototype.getAudioContext=="function")i=n.prototype.getAudioContext(),r=n.soundOut.input;else try{i=t.context;r=i.destination}catch(u){throw"connect() is meant to be used with Web Audio API or p5.sound.js";}this.audioSourceNode||(this.audioSourceNode=i.createMediaElementSource(this.elt),this.audioSourceNode.connect(r));t?t.input?this.audioSourceNode.connect(t.input):this.audioSourceNode.connect(t):this.audioSourceNode.connect(r)};n.MediaElement.prototype.disconnect=function(){if(this.audioSourceNode)this.audioSourceNode.disconnect();else throw"nothing to disconnect";};n.MediaElement.prototype.showControls=function(){this.elt.style["text-align"]="inherit";this.elt.controls=!0};n.MediaElement.prototype.hideControls=function(){this.elt.controls=!1};f=function(n,t,i,r){this.callback=n;this.time=t;this.id=i;this.val=r};n.MediaElement.prototype.addCue=function(n,t,i){var r=this._cueIDCounter++,u=new f(t,n,r,i);return this._cues.push(u),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),r};n.MediaElement.prototype.removeCue=function(n){for(var t=0;t<this._cues.length;t++)this._cues[t].id===n&&(console.log(n),this._cues.splice(t,1));this._cues.length===0&&(this.elt.ontimeupdate=null)};n.MediaElement.prototype.clearCues=function(){this._cues=[];this.elt.ontimeupdate=null};n.MediaElement.prototype._onTimeUpdate=function(){for(var t,r,i=this.time(),n=0;n<this._cues.length;n++)t=this._cues[n].time,r=this._cues[n].val,this._prevTime<t&&t<=i&&this._cues[n].callback(r);this._prevTime=i};n.File=function(n,t){this.file=n;this._pInst=t;var i=n.type.split("/");this.type=i[0];this.subtype=i[1];this.name=n.name;this.size=n.size;this.data=undefined}});